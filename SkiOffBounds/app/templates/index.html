{% extends "base.html" %}
{% load static %}
{% load i18n %}  {# ← IMPORTANTE #}

{% block extra_scripts %}
    <script src="{% static 'js/search.js' %}" defer></script>
    <script src="{% static 'js/filters.js' %}" defer></script>
    <script src="{% static 'js/status.js' %}" defer></script>
{% endblock %}


{% block contenido %}
<!-- Hero Section -->
<section class="hero">
    <div class="hero-content">
        <h1 class="hero-title">{% trans "Descubre tu próxima aventura en las montañas" %}</h1>
        <p class="hero-subtitle">{% trans "Explora las mejores estaciones de esquí del mundo" %}</p>
        <a href="#estaciones" class="hero-cta">{% trans "Explorar Estaciones" %}</a>
    </div>
</section>

<!-- Search and Filter Section -->
<section class="search-filter-section">
    <div class="search-filter-container">
        <div class="search-box">
            <i class="bi bi-search"></i>
            <!-- Nota: Traducir atributos como placeholder -->
            <input type="text" id="search-estaciones" placeholder="{% trans 'Buscar estaciones...' %}" autocomplete="off">
            <div id="search-results" class="search-results"></div>
        </div>
        
        <div class="filter-box">
            <i class="bi bi-funnel"></i>
            <select id="filter-localizacion" class="filter-select">
                <option value="">{% trans "Todas las localizaciones" %}</option>
                {% for loc in localizaciones %}
                <option value="{{ loc.id }}">{{ loc.nombre }}</option>
                {% endfor %}
            </select>
        </div>
    </div>
</section>

<!-- Estaciones Section -->
<section id="estaciones" class="estaciones-section">
    <div class="section-header">
        <h2 class="section-title">{% trans "Estaciones Destacadas" %}</h2>
        <p class="section-subtitle">{% trans "Por cada localización" %}</p>
    </div>

    <div class="cards-grid" id="estaciones-container">
        {% for e in lista_estaciones %}
        <div class="card" {% if e.imagen_portada %}style="--bg-image: url('{{ e.imagen_portada.url }}');"{% endif %}>
            <div class="card-overlay"></div>
            <div class="card-content">
                <h3 class="card-title">{{ e.nombre }}</h3>
                <p class="card-location">{{ e.localizacion.nombre }}</p>
                
                <div class="card-stats">
                    <!-- Los datos dinámicos (km, m) no se traducen, pero las unidades sí podrían si quisieras -->
                    <div class="stat">
                        <i class="bi bi-graph-up"></i>
                        <span>{{ e.km_pistas_totales }} km</span>
                    </div>
                    <div class="stat">
                        <i class="bi bi-arrow-up"></i>
                        <span>{{ e.altitud_minima }}-{{ e.altitud_maxima }} m</span>
                    </div>
                </div>

                {% if e.precio %}
                <div class="card-price">
                    <span class="price-label">{% trans "Desde" %}</span>
                    <span class="price-value">{{ e.precio }}€</span>
                </div>
                {% endif %}

                <div class="card-actions">
                    <a href="{% url 'skioffbounds:estacion_detalle' e.id %}" class="card-link">{% trans "Ver Detalles" %}</a>
                    <button class="btn-favorito" data-estacion-id="{{ e.id }}" title="{% trans 'Añadir a favoritos' %}">
                        <i class="bi bi-star"></i>
                    </button>
                </div>
                               
                <div class="live-status" data-id="{{ e.id }}">
                    <span class="status-badge pending">
                        <i class="bi bi-activity"></i> {% trans "Consultar estado" %}
                    </span>
                    <div class="status-details" style="display: none;">
                        <!-- Aquí se inyectará el AJAX -->
                    </div>
                </div>

            </div>
        </div>
        {% endfor %}
    </div>
</section>
{% endblock %}
